# ë„¤ì´ë²„ ë¡œê·¸ì¸ API ì„¤ì • ê°€ì´ë“œ (Naver OAuth)

## ğŸ“ ì‚¬ì „ ì¤€ë¹„ì‚¬í•­

- ë„¤ì´ë²„ ê³„ì • (ê°œì¸ ë˜ëŠ” ì‚¬ì—…ì)
- ê°œë°œ ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ Callback URL

## ğŸ”§ ë‹¨ê³„ë³„ ì„¤ì •

### 1ë‹¨ê³„: ë„¤ì´ë²„ ê°œë°œì ì„¼í„° ì ‘ì†

1. [ë„¤ì´ë²„ ê°œë°œì ì„¼í„°](https://developers.naver.com/) ì ‘ì†
2. ìš°ì¸¡ ìƒë‹¨ "ë¡œê·¸ì¸" í´ë¦­ â†’ ë„¤ì´ë²„ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸
3. ë¡œê·¸ì¸ í›„ ìƒë‹¨ ë©”ë‰´ì—ì„œ **"Application"** í´ë¦­

### 2ë‹¨ê³„: ì• í”Œë¦¬ì¼€ì´ì…˜ ë“±ë¡

1. **"ì• í”Œë¦¬ì¼€ì´ì…˜ ë“±ë¡"** ë²„íŠ¼ í´ë¦­
2. **ë˜ëŠ”** ì§ì ‘ URL ì ‘ì†: https://developers.naver.com/apps/#/register

### 3ë‹¨ê³„: ê¸°ë³¸ ì •ë³´ ì…ë ¥

#### 3-1. ì• í”Œë¦¬ì¼€ì´ì…˜ ì •ë³´

| í•­ëª© | ì…ë ¥ ê°’ | ì„¤ëª… |
|------|--------|------|
| **ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë¦„** | `MSC Cruises` | ì‚¬ìš©ìì—ê²Œ í‘œì‹œë  ì•± ì´ë¦„ |
| **ì‚¬ìš© API** | âœ… **ë„¤ì´ë²„ ë¡œê·¸ì¸** | ë°˜ë“œì‹œ ì²´í¬ |

#### 3-2. ì œê³µ ì •ë³´ ì„ íƒ (í•„ìˆ˜ ë° ì„ íƒ í•­ëª©)

**í•„ìˆ˜ ì •ë³´** (ë°˜ë“œì‹œ ì²´í¬):
- âœ… íšŒì› ì´ë©”ì¼ ì£¼ì†Œ
- âœ… íšŒì› ì´ë¦„

**ì„ íƒ ì •ë³´** (ê¶Œì¥):
- â˜‘ í”„ë¡œí•„ ì‚¬ì§„

> **ğŸ’¡ ì°¸ê³ **: ì œê³µë°›ì„ ì •ë³´ê°€ ë§ì„ìˆ˜ë¡ ì‚¬ìš©ì ê²½í—˜ì´ í–¥ìƒë˜ì§€ë§Œ, ê°œì¸ì •ë³´ ì œê³µ ë™ì˜ í™”ë©´ì´ ë³µì¡í•´ì§‘ë‹ˆë‹¤.

#### 3-3. ë¡œê·¸ì¸ ì˜¤í”ˆ API ì„œë¹„ìŠ¤ í™˜ê²½

**PC ì›¹** ì²´í¬ (í•„ìˆ˜)

| í•­ëª© | ì…ë ¥ ê°’ | ì„¤ëª… |
|------|--------|------|
| **ì„œë¹„ìŠ¤ URL** | `http://localhost:3000` | ê°œë°œ í™˜ê²½ URL |
| **ë„¤ì´ë²„ ì•„ì´ë””ë¡œ ë¡œê·¸ì¸ Callback URL** | `http://localhost:3000/api/auth/callback/naver` | NextAuth ì½œë°± URL |

> âš ï¸ **ì£¼ì˜**: Callback URLì€ **ì •í™•íˆ** ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤. ëì— `/`ê°€ ìˆìœ¼ë©´ ì•ˆ ë©ë‹ˆë‹¤!

### 4ë‹¨ê³„: ë“±ë¡ ì™„ë£Œ ë° ì •ë³´ í™•ì¸

1. ëª¨ë“  ì •ë³´ ì…ë ¥ í›„ **"ë“±ë¡í•˜ê¸°"** í´ë¦­
2. ë“±ë¡ ì™„ë£Œ í™”ë©´ì—ì„œ ë‹¤ìŒ ì •ë³´ë¥¼ í™•ì¸:

```
âœ… Client ID: AbCdEfGhIjKlMnOp (ì˜ˆì‹œ)
âœ… Client Secret: XyZ12345Ab (ì˜ˆì‹œ)
```

3. **Client ID**ì™€ **Client Secret**ì„ ë³µì‚¬í•˜ì—¬ ì•ˆì „í•œ ê³³ì— ë³´ê´€

### 5ë‹¨ê³„: í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

1. í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ `.env` íŒŒì¼ ì—´ê¸°
2. ë³µì‚¬í•œ ì •ë³´ë¥¼ ì…ë ¥:

```bash
NAVER_CLIENT_ID="AbCdEfGhIjKlMnOp"
NAVER_CLIENT_SECRET="XyZ12345Ab"
```

3. íŒŒì¼ ì €ì¥

### 6ë‹¨ê³„: ê°œë°œ ì„œë²„ ì¬ì‹œì‘

í™˜ê²½ ë³€ìˆ˜ë¥¼ ë³€ê²½í–ˆìœ¼ë¯€ë¡œ **ì„œë²„ë¥¼ ì¬ì‹œì‘**í•´ì•¼ í•©ë‹ˆë‹¤:

```bash
# ê¸°ì¡´ ì„œë²„ ì¢…ë£Œ (Ctrl + C)
# ì„œë²„ ì¬ì‹œì‘
npm run dev
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸

### 1. ë¡œê·¸ì¸ í˜ì´ì§€ ì ‘ì†

http://localhost:3000/login

### 2. "ë„¤ì´ë²„ë¡œ ë¡œê·¸ì¸" ë²„íŠ¼ í´ë¦­

ì´ˆë¡ìƒ‰ ë„¤ì´ë²„ ë¡œê·¸ì¸ ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.

### 3. ë„¤ì´ë²„ ë¡œê·¸ì¸ í™”ë©´

ë„¤ì´ë²„ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë©ë‹ˆë‹¤:
- ë„¤ì´ë²„ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸
- ì •ë³´ ì œê³µ ë™ì˜ (í•„ìˆ˜: ì´ë©”ì¼, ì´ë¦„)

### 4. ì¸ì¦ ì„±ê³µ

- ë¡œê·¸ì¸ ì„±ê³µ ì‹œ ëŒ€ì‹œë³´ë“œë¡œ ìë™ ì´ë™
- ì‹ ê·œ ì‚¬ìš©ìëŠ” ìë™ìœ¼ë¡œ íšŒì›ê°€ì… ë° MSC Voyagers Club ê°€ì…

---

## ğŸ” ì• í”Œë¦¬ì¼€ì´ì…˜ ê´€ë¦¬

### ë“±ë¡í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ í™•ì¸ ë° ìˆ˜ì •

1. [ë„¤ì´ë²„ ê°œë°œì ì„¼í„°](https://developers.naver.com/) ì ‘ì†
2. "Application" â†’ "ë‚´ ì• í”Œë¦¬ì¼€ì´ì…˜" í´ë¦­
3. ë“±ë¡í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„ íƒ
4. ì •ë³´ ìˆ˜ì • ê°€ëŠ¥:
   - ì„œë¹„ìŠ¤ URL
   - Callback URL
   - ì œê³µ ì •ë³´
   - API ì„¤ì •

### Client Secret ì¬ë°œê¸‰

ë³´ì•ˆìƒ Client Secretì´ ë…¸ì¶œëœ ê²½ìš°:
1. ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒì„¸ í˜ì´ì§€ ì ‘ì†
2. "Client Secret" ì˜† **"ì¬ë°œê¸‰"** ë²„íŠ¼ í´ë¦­
3. ìƒˆë¡œìš´ Secretì„ `.env` íŒŒì¼ì— ì—…ë°ì´íŠ¸

---

## ğŸš€ í”„ë¡œë•ì…˜ ë°°í¬ ì‹œ

### 1. ì„œë¹„ìŠ¤ URL ì¶”ê°€

ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¤ì •ì—ì„œ í”„ë¡œë•ì…˜ ë„ë©”ì¸ ì¶”ê°€:

| í™˜ê²½ | ì„œë¹„ìŠ¤ URL | Callback URL |
|------|-----------|--------------|
| ê°œë°œ | http://localhost:3000 | http://localhost:3000/api/auth/callback/naver |
| í”„ë¡œë•ì…˜ | https://msccruises.com | https://msccruises.com/api/auth/callback/naver |

> ğŸ’¡ **íŒ**: ê°œë°œ/í”„ë¡œë•ì…˜ URLì„ ëª¨ë‘ ë“±ë¡í•˜ë©´ ë‘ í™˜ê²½ì—ì„œ ë™ì‹œì— ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.

### 2. í™˜ê²½ ë³€ìˆ˜ ì—…ë°ì´íŠ¸

í”„ë¡œë•ì…˜ ì„œë²„ì˜ `.env` íŒŒì¼:

```bash
NEXTAUTH_URL="https://msccruises.com"
NAVER_CLIENT_ID="ì‹¤ì œ_í´ë¼ì´ì–¸íŠ¸_ID"
NAVER_CLIENT_SECRET="ì‹¤ì œ_í´ë¼ì´ì–¸íŠ¸_ì‹œí¬ë¦¿"
```

### 3. ê²€ìˆ˜ ì‹ ì²­ (ì„ íƒ ì‚¬í•­)

**ì •ì‹ ì„œë¹„ìŠ¤ë¥¼ ìœ„í•œ ê²€ìˆ˜**:
1. ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒì„¸ í˜ì´ì§€ì—ì„œ "ê²€ìˆ˜ ìš”ì²­" í´ë¦­
2. í•„ìš” ì„œë¥˜ ì œì¶œ:
   - ì‚¬ì—…ìë“±ë¡ì¦ (ë²•ì¸/ê°œì¸ì‚¬ì—…ì)
   - ì„œë¹„ìŠ¤ ì„¤ëª…ì„œ
   - ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨
3. ë„¤ì´ë²„ ê²€ìˆ˜íŒ€ ì‹¬ì‚¬ (1-2ì£¼ ì†Œìš”)
4. ìŠ¹ì¸ í›„ ì •ì‹ ì„œë¹„ìŠ¤ ê°€ëŠ¥

> **ì°¸ê³ **: ê²€ìˆ˜ ì „ì—ë„ í…ŒìŠ¤íŠ¸ ë° ê°œë°œì€ ê°€ëŠ¥í•˜ì§€ë§Œ, ì¼ì¼ API í˜¸ì¶œ ì œí•œì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## â“ ë¬¸ì œ í•´ê²° (Troubleshooting)

### 1. "í˜ì´ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤" ì—ëŸ¬

**ì—ëŸ¬ URL ì˜ˆì‹œ:**
```
https://nid.naver.com/inform/inform_404.html?error=invalid_request&error_description=client%20info%20invalid
```

**ì›ì¸ ë° í•´ê²°:**

| ì›ì¸ | í•´ê²° ë°©ë²• |
|------|----------|
| Client ID ì˜¤ë¥˜ | `.env` íŒŒì¼ì˜ `NAVER_CLIENT_ID` í™•ì¸ |
| Client Secret ì˜¤ë¥˜ | `.env` íŒŒì¼ì˜ `NAVER_CLIENT_SECRET` í™•ì¸ |
| Callback URL ë¶ˆì¼ì¹˜ | ë„¤ì´ë²„ ê°œë°œì ì„¼í„°ì™€ ì‹¤ì œ URL ì¼ì¹˜ í™•ì¸ |
| ì„œë²„ ì¬ì‹œì‘ ì•ˆ í•¨ | í™˜ê²½ ë³€ìˆ˜ ë³€ê²½ í›„ `npm run dev` ì¬ì‹¤í–‰ |

### 2. "ë™ì˜ í•­ëª© ëˆ„ë½" ì—ëŸ¬

**ì›ì¸**: í•„ìˆ˜ ì œê³µ ì •ë³´ê°€ ì²´í¬ë˜ì§€ ì•ŠìŒ

**í•´ê²°**:
1. ë„¤ì´ë²„ ê°œë°œì ì„¼í„° â†’ ë‚´ ì• í”Œë¦¬ì¼€ì´ì…˜ â†’ ìˆ˜ì •
2. "ì œê³µ ì •ë³´ ì„ íƒ"ì—ì„œ **ì´ë©”ì¼**ê³¼ **ì´ë¦„** ì²´í¬ í™•ì¸

### 3. "redirect_uri_mismatch" ì—ëŸ¬

**ì›ì¸**: Callback URLì´ ì •í™•íˆ ì¼ì¹˜í•˜ì§€ ì•ŠìŒ

**í™•ì¸ ì‚¬í•­**:
- âœ… í”„ë¡œí† ì½œ: `http://` (ê°œë°œ) ë˜ëŠ” `https://` (í”„ë¡œë•ì…˜)
- âœ… ë„ë©”ì¸: `localhost:3000` (ê°œë°œ) ë˜ëŠ” `msccruises.com` (í”„ë¡œë•ì…˜)
- âœ… ê²½ë¡œ: `/api/auth/callback/naver`
- âœ… ëì— `/` ì—†ìŒ

### 4. ë¡œê·¸ì¸ í›„ ì‚¬ìš©ì ì •ë³´ê°€ ì €ì¥ë˜ì§€ ì•ŠìŒ

**í™•ì¸ ì‚¬í•­**:
1. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í™•ì¸: `npx prisma studio`
2. NextAuth ì„¤ì • í™•ì¸: `lib/auth.ts`
3. ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸

---

## ğŸ“¸ ìŠ¤í¬ë¦°ìƒ· ê°€ì´ë“œ

### 1. ì• í”Œë¦¬ì¼€ì´ì…˜ ë“±ë¡ í™”ë©´

![ì• í”Œë¦¬ì¼€ì´ì…˜ ë“±ë¡](https://developers.naver.com/inc/devcenter/images/cont/img_app_register_001.png)

### 2. ì œê³µ ì •ë³´ ì„ íƒ

![ì œê³µ ì •ë³´](https://developers.naver.com/inc/devcenter/images/cont/img_app_register_002.png)

### 3. ë“±ë¡ ì™„ë£Œ ë° Client ID/Secret í™•ì¸

![ë“±ë¡ ì™„ë£Œ](https://developers.naver.com/inc/devcenter/images/cont/img_app_register_003.png)

---

## ğŸ”— ê´€ë ¨ ë§í¬

- [ë„¤ì´ë²„ ê°œë°œì ì„¼í„°](https://developers.naver.com/)
- [ë„¤ì´ë²„ ë¡œê·¸ì¸ API ëª…ì„¸](https://developers.naver.com/docs/login/api/)
- [ë„¤ì´ë²„ ë¡œê·¸ì¸ ê°€ì´ë“œ](https://developers.naver.com/docs/login/web/)
- [NextAuth.js ê³µì‹ ë¬¸ì„œ](https://next-auth.js.org/)

---

## ğŸ“ ì§€ì›

ë¬¸ì œê°€ ê³„ì†ë˜ëŠ” ê²½ìš°:
1. ë„¤ì´ë²„ ê°œë°œì ì„¼í„° Q&A: https://developers.naver.com/support/
2. NextAuth.js GitHub Issues: https://github.com/nextauthjs/next-auth/issues
